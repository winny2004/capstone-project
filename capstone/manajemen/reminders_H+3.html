<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PITCAR Dashboard Reminder H+3</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Oxygen, Ubuntu, Cantarell, sans-serif;
        background: #f5f5f5;
      }

      .sidebar {
        position: fixed;
        left: 0;
        top: 0;
        height: 100vh;
        width: 50px;
        background: #ffffff;
        transition: width 0.3s ease;
        overflow: hidden;
        z-index: 1000;
        box-shadow: 2px 0 8px rgba(0, 0, 0, 0.1);
      }

      .sidebar.expanded {
        width: 220px;
      }

      .logo {
        display: flex;
        align-items: center;
        padding: 12px;
        background: white;
        height: 55px;
        border-bottom: 1px solid #e0e0e0;
      }

      .logo-icon {
        width: 32px;
        height: 32px;
        object-fit: contain;
        margin-right: 10px;
        margin-left: -3px;
      }

      .logo-text {
        margin-left: 2px;
        height: 28px;
        width: auto;
        object-fit: contain;
      }

      .menu {
        padding-top: 8px;
        display: flex;
        flex-direction: column;
        height: calc(100vh - 55px);
      }

      .menu-item {
        display: flex;
        align-items: center;
        padding: 13px 12px;
        color: #666;
        text-decoration: none;
        transition: all 0.2s;
        cursor: pointer;
        position: relative;
      }

      .menu-item:hover {
        background: #f5f5f5;
        color: #d32f2f;
      }

      .menu-item.active {
        background: #bd0404;
        color: white;
        padding: 8px;
        border-radius: 12px;
        margin: 4px;
      }

      .menu-icon {
        width: 20px;
        height: 20px;
        min-width: 20px;
        object-fit: contain;
        display: block;
        margin-left: 3px;
      }

      .menu-item.active .menu-icon {
        filter: brightness(0) invert(1);
      }

      .menu-user .menu-text {
        display: flex;
        flex-direction: column;
      }

      .menu-user .main-text {
        font-size: 14px;
        font-weight: 600;
      }

      .menu-user .sub-text {
        font-size: 10px;
        color: #888888;
      }

      .menu-user {
        margin-top: auto;
        padding-top: 20px;
      }

      .menu-text {
        margin-left: 18px;
        white-space: nowrap;
        font-size: 14px;
        font-weight: 500;
      }

      .new-badge {
        margin-left: 20px;
        background-color: #d4f5d4;
        color: #28a745;
        font-size: 0.7rem;
        font-weight: 400;
        padding: 5px 10px;
        border-radius: 10px;
        line-height: 1;
        display: inline-block;
        vertical-align: middle;
      }
      .main-content {
        margin-left: 50px;
        transition: margin-left 0.3s ease;
      }

      .main-content.expanded {
        margin-left: 220px;
      }

      .dashboard {
        max-width: 1200px;
        margin-top: 10px;
        margin-left: 10px;
        margin-right: 10px;
        margin-bottom: 10px;
        padding: 25px;
        background: rgb(255, 255, 255);
        border-radius: 8px;
      }

     
      .header h1 {
  font-size: 20px;  
  font-weight: 700;
}


      .subtext {
        color: #666;
        font-size: 14px;
        margin-top: 3px;
      }
      /* Stats cards */

      .stats {
        display: flex;
        gap: 15px;
        margin-top: 20px;
      }

      .card {
        background: #fff;
        flex: 1;
        border-radius: 8px;
        padding: 15px 20px;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
      }

      .card h3 {
        font-size: 14px;
        color: #666;
      }

      .card p {
        font-size: 20px;
        font-weight: 600;
        margin-top: 6px;
      }
    /* Follow Up Hari Ini Card */
.followup-card {
  background: #faf7f7;
  border-radius: 12px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
  margin-top: 20px;
  overflow: hidden;
}

/* Header title */
.followup-title {
  font-size: 18px;
  font-weight: 600;
  color: #111;
  padding: 16px 20px;
  border-bottom: 1px solid #e6e6e6;
}

/* Body text */
.followup-body {
  text-align: center;
  padding: 24px 20px;
}

.followup-body .main-text {
  color: #555;
  font-size: 15px;
  font-weight: 500;
  margin-bottom: 4px;
}

.followup-body .sub-text {
  color: #999;
  font-size: 13px;
}

    


      /* Table Section */

      .table-section {
        background: #fff;
        margin-top: 20px;
        padding: 15px 20px;
        border-radius: 8px;
        display: flex;
        flex-direction: column;
      }

      .table-section h3 {
        font-size: 16px;
        font-weight: 600;
        margin-bottom: 15px;
      }

      .filters {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-bottom: 10px;
        align-items: end;
      }

      .custom-date-range {
        display: none;
        gap: 10px;
      }

      .filter-group {
        display: flex;
        flex-direction: column;
      }

      .filter-group label {
        font-size: 12px;
        color: #666;
        margin-bottom: 4px;
        font-weight: 500;
      }

      .filters select,
      .filters input {
        padding: 6px 8px;
        font-size: 14px;
        border-radius: 6px;
        border: 1px solid #ccc;
      }

      .table-container {
        max-height: 420px;
        overflow-y: scroll;
        border-top: 1px solid #eee;
      }

      table {
        width: 100%;
        border-collapse: collapse;
      }

      th,
      td {
        padding: 10px 8px;
        border-bottom: 1px solid #eee;
        text-align: left;
        font-size: 13px;
      }

      th {
        color: #555;
        background-color: #fafafa;
        font-weight: 600;
      }
      /* Status badge styling */

      .status-badge {
        background-color: #f5f5f5;
        padding: 4px 8px;
        border-radius: 4px;
        display: inline-block;
        text-align: center;
      }

      td a {
        color: #c20000;
        text-decoration: none;
        font-weight: 600;
        white-space: pre-line;
      }

      td a:hover {
        text-decoration: underline;
      }
      /* Pagination */

      .pagination {
        margin-top: 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 13px;
      }

      .pagination-left {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .pagination-right {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .pagination button {
        background: #fff;
        border: 1px solid #ccc;
        border-radius: 6px;
        padding: 4px 10px;
        cursor: pointer;
      }

      .pagination button.active {
        background: #c20000;
        color: #fff;
        border-color: #c20000;
      }

      .pagination button:hover {
        background: #fbeaea;
      }

      .logout-popup {
        position: fixed;
        bottom: 50px;
        left: 10px;
        background: white;
        border: 1px solid #ccc;
        padding: 8px 12px;
        border-radius: 6px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        z-index: 1001;
        font-size: 14px;
        color: #333;
      }
    </style>
  </head>

  <body>
    <div class="sidebar" id="sidebar">
      <div class="logo">
        <img src="../image/logopitcar.png" alt="Logo" class="logo-icon" />
        <img src="../image/pitcar.png" alt="PITCAR" class="logo-text" />
      </div>

      <div class="menu">
        <a href="dashboard.html" class="menu-item">
          <img src="../image/ikonhome.png" alt="Dashboard" class="menu-icon" />
          <span class="menu-text">Dashboard</span>
        </a>
        <a href="reviews.html" class="menu-item">
          <img src="../image/ikonreviews.png" alt="Reviews" class="menu-icon" />
          <span class="menu-text">Reviews</span>
        </a>
        <a href="survey.html" class="menu-item">
          <img src="../image/ikonsurvey.png" alt="Survey" class="menu-icon" />
          <span class="menu-text">Survey</span>
        </a>
        <a href="reminders_H+3.html" class="menu-item active">
          <img
            src="../image/ikonremindersH+3.png"
            alt="Reminder"
            class="menu-icon" />
          <span class="menu-text">Reminder H+3</span>
        </a>
        <a href="reminders.html" class="menu-item">
          <img
            src="../image/ikonreminders.png"
            alt="Reminders"
            class="menu-icon" />
          <span class="menu-text">
            Reminders
            <span class="new-badge">New</span>
          </span>
        </a>
        <div class="menu-item menu-user" id="user-btn">
          <img src="../image/ikonuser.png" alt="User" class="menu-icon" />
          <span class="menu-text">
            <span class="main-text">Pitcar Service</span>
            <span class="sub-text">User</span>
          </span>
        </div>
      </div>

      <!-- ðŸ”½ Pop Up Logout (posisi fix di kiri bawah sidebar) -->
      <div class="logout-popup" id="logout-popup" style="display: none;" onclick="window.location.href='login.html'">Logout</div>
    </div>

    <div class="main-content" id="mainContent">
     <div class="dashboard">
       <div class="header">
         <div class="header-left">
           <h1>Dashboard Reminder H+3</h1>
           <p>Follow up pelanggan setelah 3 hari servis</p>
         </div>
        

      <div class="stats">
        <div class="card">
          <h3>Pending Reminder</h3>
          <p>7 order</p>
        </div>
        <div class="card">
          <h3>Total Reminder Sent</h3>
          <p>3644 reminders</p>
        </div>
        <div class="card">
          <h3>Feedback Received</h3>
          <p>366 responses</p>
        </div>
        <div class="card">
          <h3>Response Rate</h3>
          <p>10.56%</p>
        </div>
      </div>


          <!-- Follow Up Hari Ini -->
    <div class="followup-card">
      <div class="followup-title">Follow Up Hari Ini</div>
      <div class="followup-body">
        <p class="main-text">Sudah tidak ada reminder hari ini</p>
        <p class="sub-text">Semua pelanggan sudah direminder</p>
      </div>
    </div>

      <div class="table-section">
        <h3>Service History & Reminder Status</h3>
        <div class="filters">
          <div class="filter-group">
            <label for="searchCustomer">Cari Pelanggan</label>
            <input
              type="text"
              id="searchCustomer"
              placeholder="Order/Customer atau Plat" />
          </div>
          <div class="filter-group">
            <label for="rangeTanggal">Range Tanggal</label>
            <select id="rangeTanggal">
              <option>Semua Waktu</option>
              <option>Hari Ini</option>
              <option>Minggu Ini</option>
              <option>Tahun Ini</option>
              <option>Custom Range</option>
            </select>
          </div>
          <div class="custom-date-range" id="customDateRange">
            <div class="filter-group">
              <label for="tanggalAwal">Tanggal Awal</label>
              <input type="date" id="tanggalAwal" />
            </div>
            <div class="filter-group">
              <label for="tanggalAkhir">Tanggal Akhir</label>
              <input type="date" id="tanggalAkhir" />
            </div>
          </div>
          <div class="filter-group">
            <label for="statusReminder">Status Reminder</label>
            <select id="statusReminder">
              <option>Semua Status</option>
              <option>Belum Di Reminder</option>
              <option>Sudah Direminder</option>
              <option>Sudah Feedback</option>
            </select>
          </div>
        </div>

        <div
          id="errorMessage"
          style="
            display: none;
            color: red;
            text-align: center;
            padding: 20px;
            font-size: 16px;
          ">
          Failed to fetch history data<br />Try Again
        </div>

        <script>
          // Toggle Sidebar saat diklik
          const sidebar = document.getElementById("sidebar");
          const mainContent = document.getElementById("mainContent");

          // Desktop hover otomatis
          sidebar.addEventListener("pointerenter", () => {
            sidebar.classList.add("expanded");
            mainContent.classList.add("expanded");
          });

          sidebar.addEventListener("pointerleave", () => {
            sidebar.classList.remove("expanded");
            mainContent.classList.remove("expanded");
          });
        </script>

        <div class="table-container">
          <table id="reminderTable">
            <thead>
              <tr>
                <th>Order No</th>
                <th>Customer</th>
                <th>Plat No</th>
                <th>Service Advisor</th>
                <th>Status Reminder</th>
                <th>Feedback</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody id="tableBody">
              <!-- Dummy data will be populated by JavaScript -->
            </tbody>
          </table>
        </div>

        <div class="pagination">
          <div class="pagination-left">
            <select id="itemsPerPage">
              <option value="10">10 / Page</option>
              <option value="25">25 / Page</option>
              <option value="50">50 / Page</option>
              <option value="100">100 / Page</option>
            </select>
            <span id="showingInfo">Showing 1-10 of 7291</span>
          </div>
          <div class="pagination-right">
            <button>First</button>
            <button class="active">1</button>
            <button>2</button>
            <button>3</button>
            <button>4</button>
            <button>5</button>
            <button>Last</button>
          </div>
        </div>
      </div>
    </div>
    <script>
      // Dummy data with diverse statuses and dates
      const dummyData = [
        {
          orderNo: "S17154",
          customer: "Otoklix",
          phone: "0819877777",
          platNo: "AA1568PR",
          serviceAdvisor: "Rizqo Rusli Erdiantoro",
          statusReminder: "Belum Di Reminder",
          feedback: "Belum ada feedback",
          serviceDate: "2025-11-11",
        },
        {
          orderNo: "S17155",
          customer: "Bu Sari Dewi Ratna",
          phone: "0823456789",
          platNo: "B1234CD",
          serviceAdvisor: "Ahmad Rahman",
          statusReminder: "Sudah Direminder",
          feedback: {
            rating: 3,
            message: "Pelayanan cukup baik, tapi bisa lebih cepat",
            date: "2025-11-11",
          },
          serviceDate: "2025-11-11",
          sentDateTime: "2025-11-10 14:30",
        },
        {
          orderNo: "S17156",
          customer: "Pak Budi Santoso",
          phone: "0834567890",
          platNo: "D5678EF",
          serviceAdvisor: "Maya Sari",
          statusReminder: "Sudah Feedback",
          feedback: {
            rating: 4,
            message: "Pelayanan bagus, terima kasih",
            date: "2025-11-11 15:30",
          },
          serviceDate: "2025-11-11",
        },
        {
          orderNo: "S17157",
          customer: "Ibu Rina Kartika",
          phone: "0845678901",
          platNo: "F9012GH",
          serviceAdvisor: "Denny Kusuma",
          statusReminder: "Belum Di Reminder",
          feedback: "Belum ada feedback",
          serviceDate: "2025-11-04",
        },
        {
          orderNo: "S17158",
          customer: "Pak Joko Widodo",
          phone: "0856789012",
          platNo: "H3456IJ",
          serviceAdvisor: "Siti Nurhaliza",
          statusReminder: "Sudah Direminder",
          feedback: {
            rating: 2,
            message: "Harga terlalu mahal untuk servis sekedar ganti oli",
            date: "2025-11-05",
          },
          serviceDate: "2025-11-05",
          sentDateTime: "2025-11-04 09:15",
        },
        {
          orderNo: "S17159",
          customer: "Bu Maya Sari",
          phone: "0867890123",
          platNo: "J7890KL",
          serviceAdvisor: "Rizqo Rusli Erdiantoro",
          statusReminder: "Sudah Feedback",
          feedback: {
            rating: 5,
            message: "Servis cepat dan memuaskan",
            date: "2025-11-06 10:45",
          },
          serviceDate: "2025-11-06",
        },
        {
          orderNo: "S17160",
          customer: "Pak Ahmad Rahman",
          phone: "0878901234",
          platNo: "L1234MN",
          serviceAdvisor: "Ahmad Rahman",
          statusReminder: "Belum Di Reminder",
          feedback: "Belum ada feedback",
          serviceDate: "2025-11-01",
        },
        {
          orderNo: "S17161",
          customer: "Ibu Siti Nurhaliza",
          phone: "0889012345",
          platNo: "N5678OP",
          serviceAdvisor: "Maya Sari",
          statusReminder: "Sudah Direminder",
          feedback: {
            rating: 4,
            message: "Staf ramah dan profesional",
            date: "2025-11-08",
          },
          serviceDate: "2025-11-08",
          sentDateTime: "2025-11-07 16:45",
        },
        {
          orderNo: "S17162",
          customer: "Pak Denny Kusuma",
          phone: "0890123456",
          platNo: "P9012QR",
          serviceAdvisor: "Denny Kusuma",
          statusReminder: "Sudah Feedback",
          feedback: {
            rating: 5,
            message: "Mekanik sangat profesional",
            date: "2025-11-09 14:20",
          },
          serviceDate: "2025-11-09",
        },
        {
          orderNo: "S17163",
          customer: "Bu Linda Putri",
          phone: "0811234567",
          platNo: "R3456ST",
          serviceAdvisor: "Siti Nurhaliza",
          statusReminder: "Belum Di Reminder",
          feedback: "Belum ada feedback",
          serviceDate: "2025-11-10",
        },
        {
          orderNo: "S17164",
          customer: "Pak Eko Prasetyo",
          phone: "0822345678",
          platNo: "T7890UV",
          serviceAdvisor: "Rizqo Rusli Erdiantoro",
          statusReminder: "Sudah Direminder",
          feedback: {
            rating: 3,
            message: "Servis baik, tapi antrian cukup lama",
            date: "2025-10-15",
          },
          serviceDate: "2025-10-15",
          sentDateTime: "2025-10-14 11:20",
        },
        {
          orderNo: "S17165",
          customer: "Ibu Ani Suryani",
          phone: "0833456789",
          platNo: "V1234WX",
          serviceAdvisor: "Ahmad Rahman",
          statusReminder: "Sudah Feedback",
          feedback: {
            rating: 4,
            message: "Harga terjangkau dan kualitas baik",
            date: "2025-10-20 12:10",
          },
          serviceDate: "2025-10-20",
        },
        {
          orderNo: "S17166",
          customer: "Pak Hendro Wicaksono",
          phone: "0844567890",
          platNo: "X5678YZ",
          serviceAdvisor: "Maya Sari",
          statusReminder: "Belum Di Reminder",
          feedback: "Belum ada feedback",
          serviceDate: "2025-10-25",
        },
        {
          orderNo: "S17167",
          customer: "Bu Ratih Permata",
          phone: "0855678901",
          platNo: "Z9012AA",
          serviceAdvisor: "Denny Kusuma",
          statusReminder: "Sudah Direminder",
          feedback: {
            rating: 3,
            message: "Pelayanan standar, tidak ada masalah",
            date: "2025-09-15",
          },
          serviceDate: "2025-09-15",
          sentDateTime: "2025-09-14 13:00",
        },
        {
          orderNo: "S17168",
          customer: "Pak Yoga Pratama",
          phone: "0866789012",
          platNo: "AB3456CD",
          serviceAdvisor: "Siti Nurhaliza",
          statusReminder: "Sudah Feedback",
          feedback: {
            rating: 5,
            message: "Pelayanan sangat memuaskan",
            date: "2025-09-20 16:55",
          },
          serviceDate: "2025-09-20",
        },
      ];

      let filteredData = [...dummyData];
      let currentPage = 1;
      let itemsPerPage = 10;

      function renderTable(data, page = 1) {
        const tbody = document.getElementById("tableBody");
        tbody.innerHTML = "";

        const startIndex = (page - 1) * itemsPerPage;
        const endIndex = startIndex + itemsPerPage;
        const pageData = data.slice(startIndex, endIndex);

        pageData.forEach((item) => {
          let actionText = "Kirim\nReminder";
          let statusDisplay = item.statusReminder;

          if (item.statusReminder === "Sudah Direminder") {
            actionText = "Kirim\nUlang";
            const [date, time] = item.sentDateTime.split(" ");
            statusDisplay = `<span style="background-color: #FFF7DC; padding: 4px 8px; border-radius: 4px; margin-bottom: 4px; display: inline-block;">${item.statusReminder}</span><br><small style="background: none; padding: 0;">${date}<br>${time}</small>`;
          } else if (item.statusReminder === "Sudah Feedback") {
            actionText = "";
            const [date, time] = item.feedback.date.split(" ");
            statusDisplay = `<span style="background-color: #D0F9CE; padding: 4px 8px; border-radius: 4px; margin-bottom: 4px; display: inline-block;">${
              item.statusReminder
            }</span><br><small style="background: none; padding: 0;">${date}<br>${
              time || ""
            }</small>`;
          } else {
            statusDisplay = `<span style="background-color: #f5f5f5; padding: 4px 8px; border-radius: 4px; display: inline-block;">${item.statusReminder}</span>`;
          }

          let feedbackDisplay = item.feedback;
          if (typeof item.feedback === "object" && item.feedback.rating) {
            const filledStars = "â˜…".repeat(item.feedback.rating);
            const emptyStars = "â˜†".repeat(5 - item.feedback.rating);
            feedbackDisplay = `<div><span style="color: #FFDE63;">${filledStars}</span>${emptyStars} (${item.feedback.rating}/5)</div><div>${item.feedback.message}</div><small style="font-size: 11px; color: #666;">${item.feedback.date}</small>`;
          }

          const row = document.createElement("tr");
          row.innerHTML = `
                    <td>${item.orderNo}</td>
                    <td>${item.customer}<br /><small>${item.phone}</small></td>
                    <td>${item.platNo}</td>
                    <td>${item.serviceAdvisor}</td>
                    <td style="text-align: left;">${statusDisplay}</td>
                    <td>${feedbackDisplay}</td>
                    <td>${
                      actionText ? '<a href="#">' + actionText + "</a>" : ""
                    }</td>
                `;
          tbody.appendChild(row);
        });

        renderPagination(data.length, page);
      }

      function renderPagination(totalItems, currentPage) {
        const totalPages = Math.ceil(totalItems / itemsPerPage);
        const paginationDiv = document.querySelector(".pagination");

        let paginationHTML = `
                <div class="pagination-left">
                  <select id="itemsPerPage">
                    <option value="10" ${
                      itemsPerPage === 10 ? "selected" : ""
                    }>10 / Page</option>
                    <option value="25" ${
                      itemsPerPage === 25 ? "selected" : ""
                    }>25 / Page</option>
                    <option value="50" ${
                      itemsPerPage === 50 ? "selected" : ""
                    }>50 / Page</option>
                    <option value="100" ${
                      itemsPerPage === 100 ? "selected" : ""
                    }>100 / Page</option>
                  </select>
                  <span id="showingInfo">Showing ${
                    (currentPage - 1) * itemsPerPage + 1
                  }-${Math.min(
          currentPage * itemsPerPage,
          totalItems
        )} of ${totalItems}</span>
                </div>
            `;

        if (totalPages > 1) {
          paginationHTML += '<div class="pagination-right">';

          paginationHTML += '<button onclick="goToPage(1)">First</button>';

          for (
            let i = Math.max(1, currentPage - 2);
            i <= Math.min(totalPages, currentPage + 2);
            i++
          ) {
            paginationHTML += `<button class="${
              i === currentPage ? "active" : ""
            }" onclick="goToPage(${i})">${i}</button>`;
          }

          paginationHTML += `<button onclick="goToPage(${totalPages})">Last</button>`;

          paginationHTML += "</div>";
        } else {
          paginationHTML += '<div class="pagination-right"></div>';
        }

        paginationDiv.innerHTML = paginationHTML;
      }

      function goToPage(page) {
        currentPage = page;
        renderTable(filteredData, currentPage);
      }

      function filterData() {
        const searchTerm = document
          .getElementById("searchCustomer")
          .value.toLowerCase();
        const statusFilter = document.getElementById("statusReminder").value;
        const dateFilter = document.getElementById("rangeTanggal").value;
        const startDate = document.getElementById("tanggalAwal").value;
        const endDate = document.getElementById("tanggalAkhir").value;

        filteredData = dummyData.filter((item) => {
          // Search filter
          const matchesSearch =
            !searchTerm ||
            item.orderNo.toLowerCase().includes(searchTerm) ||
            item.customer.toLowerCase().includes(searchTerm) ||
            item.platNo.toLowerCase().includes(searchTerm);

          // Status filter
          const matchesStatus =
            statusFilter === "Semua Status" ||
            item.statusReminder === statusFilter;

          // Date filter
          let matchesDate = true;
          const serviceDate = new Date(item.serviceDate);
          const today = new Date();

          if (dateFilter === "Hari Ini") {
            matchesDate = serviceDate.toDateString() === today.toDateString();
          } else if (dateFilter === "Minggu Ini") {
            const weekStart = new Date(today);
            weekStart.setDate(today.getDate() - today.getDay());
            const weekEnd = new Date(weekStart);
            weekEnd.setDate(weekStart.getDate() + 6);
            matchesDate = serviceDate >= weekStart && serviceDate <= weekEnd;
          } else if (dateFilter === "Tahun Ini") {
            matchesDate = serviceDate.getFullYear() === today.getFullYear();
          } else if (dateFilter === "Custom Range") {
            if (startDate && endDate) {
              const start = new Date(startDate);
              const end = new Date(endDate);
              matchesDate = serviceDate >= start && serviceDate <= end;
            } else if (startDate) {
              const start = new Date(startDate);
              matchesDate = serviceDate >= start;
            } else if (endDate) {
              const end = new Date(endDate);
              matchesDate = serviceDate <= end;
            } else {
              matchesDate = true; // Show all if no dates selected
            }
          }

          return matchesSearch && matchesStatus && matchesDate;
        });

        currentPage = 1; // Reset to first page when filtering
        renderTable(filteredData, currentPage);
      }

      document.addEventListener("DOMContentLoaded", function () {
        // Initialize table
        renderTable(dummyData, 1);

        function updateView() {
          const dateFilter = document.getElementById("rangeTanggal").value;
          const customDateRange = document.getElementById("customDateRange");
          const tableContainer = document.querySelector(".table-container");
          const pagination = document.querySelector(".pagination");
          const errorMessage = document.getElementById("errorMessage");
          const startDate = document.getElementById("tanggalAwal").value;
          const endDate = document.getElementById("tanggalAkhir").value;

          if (dateFilter === "Custom Range") {
            customDateRange.style.display = "flex";
            tableContainer.style.display = "block";
            pagination.style.display = "flex";
            errorMessage.style.display = "none";
            filterData();
          } else {
            customDateRange.style.display = "none";
            tableContainer.style.display = "block";
            pagination.style.display = "flex";
            errorMessage.style.display = "none";
            filterData();
          }
        }

        // Custom date range toggle
        document
          .getElementById("rangeTanggal")
          .addEventListener("change", updateView);

        // Event listeners for filters
        document
          .getElementById("searchCustomer")
          .addEventListener("input", filterData);
        document
          .getElementById("statusReminder")
          .addEventListener("change", filterData);
        document
          .getElementById("tanggalAwal")
          .addEventListener("change", updateView);
        document
          .getElementById("tanggalAkhir")
          .addEventListener("change", updateView);

        // Event listener for items per page change
        document
          .getElementById("itemsPerPage")
          .addEventListener("change", function () {
            itemsPerPage = parseInt(this.value);
            currentPage = 1;
            renderTable(filteredData, currentPage);
          });

        // === Pop Up Logout ===
        const userBtn = document.getElementById("user-btn");
        const logoutPopup = document.getElementById("logout-popup");

        userBtn.addEventListener("click", () => {
          logoutPopup.style.display =
            logoutPopup.style.display === "block" ? "none" : "block";
        });

        document.addEventListener("click", (event) => {
          if (
            !userBtn.contains(event.target) &&
            !logoutPopup.contains(event.target)
          ) {
            logoutPopup.style.display = "none";
          }
        });
      });
    </script>
  </body>
</html>


